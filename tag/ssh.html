<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>/dev/sulami >> blog - ssh</title>
    <link rel="icon" href="https://sulami.github.io/favicon.ico" />
    <link rel="stylesheet" href="https://sulami.github.io/theme/css/main.css" />
    <link href="https://sulami.github.io/feed/rss.xml" type="application/rss+xml" rel="alternate" title="/dev/sulami >> blog RSS Feed" />

    <!--[if IE]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>

<body id="index" class="home">
    <header id="banner" class="body">
            <nav>
            <a href="https://sulami.github.io/">/dev/sulami >> blog</a> |
                <a href="https://sulami.github.io/pages/about-me.html">About me</a>
                <a href="https://sulami.github.io/category/coding.html">Coding</a>
                <a href="https://sulami.github.io/category/hardware.html">Hardware</a>
                <a href="https://sulami.github.io/category/linux.html">Linux</a>
                <a href="https://sulami.github.io/category/web.html">Web</a>
            <a href="https://sulami.github.io/feed/rss.xml">RSS</a>
            </nav>
    </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title">>> <a href="https://sulami.github.io/using-git-locally.html">Using git locally</a></h1>
<footer class="post-info">
    <span class="date">2014-07-15</span>
    |
    in <a href="https://sulami.github.io/category/coding.html">Coding</a>
    | tags: <a href="https://sulami.github.io/tag/git.html">git</a> <a href="https://sulami.github.io/tag/ssh.html">ssh</a> </footer><!-- /.post-info -->
                    <p>When you write your code, using a version control mechanism like git is
crucial, even more than writing proper unit tests, even when working on your
own, even when it is only your evening project. Just use git and commit
regularly, it will not hurt you (unless your workflow is inherently broken, but
then fix you have to fix it anyway). Committing after every logical change and
pushing when finishing the session is something I practice almost like a
religion. Not only does it keep my history accessible and enables me easy
branching and stashing (read up on <a href="http://linux.die.net/man/1/git-branch">git-branch(1)</a> and
<a href="http://linux.die.net/man/1/git-stash">git-stash(1)</a> if you do not already use them), it also serves as simple
way to mirror my repositories to other machines and backup them this way.</p>
<p>Now to have your code available everywhere, you can just push it to your
<a href="https://github.com">Github</a> or <a href="https://bitbucket.org">BitBucket</a> account, but there are pieces of code we do not
want to see there. Security-critical code, configs or other files containing
sensitive data, or just code we are not particularly proud of. To still benefit
from the network capabilities of git, we need to host git ourselves.</p>
<p>Setting up a local git mirror is not a big deal at all as the following
examples will show. Git uses ssh to transmit data over the network, which means
every toaster that is capable of running sshd should also be able to serve git
repos in a way that Github or Bitbucket do it, just without the web interface.
We assume we already have a repo containing out working directory, maybe even
some commits, does not matter. The following snippet demonstrates establishing
a git repo in my home directory which we can use to clone, push and pull.</p>
<div class="codehilite"><pre><span class="c">% mkdir -p ~/git/myrepo.git</span>
<span class="c">% cd ~/git/myrepo.git</span>
<span class="c">% git init --bare</span>
<span class="n">Initialized</span> <span class="n">empty</span> <span class="n">Git</span> <span class="n">repository</span> <span class="n">in</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">sulami</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">myrepo</span><span class="p">.</span><span class="n">git</span>
<span class="c">% cd ~/myrepo</span>
<span class="c">% git remote add origin /home/sulami/git/myrepo.git</span>
</pre></div>


<p>That is it, my local repository is now registered as <code>origin</code> in this specific
working copy, and once I pushed my commits to it, I can clone it to somewhere
else. This is usually not all that useful, I only keep a bunch of bare
repositories for archiving reasons around, to clone some old projects of mine
if I want to look something up. Local remote repositories are way more
interesting because we can use them to push changes around to various machines,
work together with others more efficiently and much more. So here is how we
setup a local remote git server, given our repo alreay exists like before. My
ssh login uses my ssh-key to sign me in.</p>
<div class="codehilite"><pre><span class="c">% ssh sulami@remote</span>
<span class="c">% mkdir -p /srv/git/myrepo.git</span>
<span class="c">% cd /srv/git/myrepo.git</span>
<span class="c">% git init --bare --shared=group</span>
<span class="n">Initialized</span> <span class="n">empty</span> <span class="n">shared</span> <span class="n">Git</span> <span class="n">repository</span> <span class="n">in</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">myrepo</span><span class="p">.</span><span class="n">git</span>
<span class="c">% exit</span>
<span class="c">% cd ~/myrepo</span>
<span class="c">% git remote add origin ssh://remote/srv/git/myrepo.git</span>
</pre></div>


<p>Do you recognize this snippet? It is almost the same as before, we just changed
some details. First, we initialize the bare repository via ssh on our remote.
We also set it up in a way that allows us to share it with a group we can add
later on, so eventual coworkers can use their own ssh-logins to use this
repository. You can now think of exposing it to the web, or maybe installing
<a href="http://git.zx2c4.com/cgit/">cgit</a> to provide a browser-friendly interface. It all depends on what
you need, but to just synchronize your code amongst several machines there is
nothing else nessecary.</p>
                </article>
<p class="paginator">
    Page 1 / 1
</p>
            </aside><!-- /#featured -->
</body>
</html>
